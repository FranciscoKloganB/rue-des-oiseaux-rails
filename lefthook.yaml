commit-msg:
  commands:
    test-commit-msg:
      run: ./.commitlint.sh {1}

output:
  - empty_summary
  - summary
  - skips

post-merge:
  parallel: false
  commands:
    install-deps:
      run: bundle install
    migrate-db:
      run: bin/rails db:migrate

pre-commit:
  parallel: false
  piped: true
  commands:
    rubocop-lint:
      glob: '*.rb'
      run: bundle exec rubocop --autocorrect {staged_files}
      stage_fixed: true

pre-push:
  parallel: true
  commands:
    rubocop-check:
      run: bundle exec rubocop
    brakeman-security:
      run: bundle exec brakeman --no-pager
    bundler-audit:
      run: bundle exec bundler-audit check --update
    test:
      run: bin/rails test
